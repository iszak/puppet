---
classes:
    - apache::mod::xsendfile

project::rails:
    uploadir_api:
        require:
            - Class[postgresql::client]
            - Class[postgresql::server]
            - Class[postgresql::lib::devel]
            - File[/usr/bin/pg_config]
            - Package[libmagic-dev]
            - Package[libsqlite3-dev]

        user: uploadir
        owner: uploadir
        group: uploadir

        repo_path: public/uploadir-api
        repo_source: git@bitbucket.org:iszak/uploadir-api.git

        web_path: public
        web_host: uploadir.dev

        database_name: uploadir_production
        database_username: uploadir_production
        database_password: md526abc04f4e0fd5082e2a2baccf35a1b1

        custom_fragment: "
XSendFile On\n
XSendFilePath /home/uploadir/public/api/uploads/\n
XSendFilePath /home/uploadir/public/api/tmp/downloads/\n
        "

package:
    libmagic-dev:
        ensure: latest

    libsqlite3-dev:
        ensure: latest
